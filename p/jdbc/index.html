<!DOCTYPE html>
<html lang="zh" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='JDBC ç®€ä»‹ JDBC (Java DataBase Connectivity, Java æ•°æ®åº“è¿æ¥) æ˜¯ä½¿ç”¨Javaè¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥— API. JDBCå…¶å®æ˜¯SUNå…¬å¸åˆ¶è®¢çš„ä¸€å¥—æ“ä½œæ•°æ®åº“çš„æ ‡å‡†æ¥å£. JDBCä¸­å®šä¹‰'>


<title>JDBC</title>

<link rel='canonical' href='https://blog.linner.asia/p/jdbc/'>

<link rel="stylesheet" href="/scss/style.min.7a68e2beb371039eca9f5e8f87aa11bdb1fdc96a55744700a091f658cd1e66a7.css">
<link rel="stylesheet" href="/css/katex.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<meta property='og:title' content='JDBC'>
<meta property='og:description' content='JDBC ç®€ä»‹ JDBC (Java DataBase Connectivity, Java æ•°æ®åº“è¿æ¥) æ˜¯ä½¿ç”¨Javaè¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥— API. JDBCå…¶å®æ˜¯SUNå…¬å¸åˆ¶è®¢çš„ä¸€å¥—æ“ä½œæ•°æ®åº“çš„æ ‡å‡†æ¥å£. JDBCä¸­å®šä¹‰'>
<meta property='og:url' content='https://blog.linner.asia/p/jdbc/'>
<meta property='og:site_name' content='Linner&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='JavaWeb' /><meta property='article:tag' content='Java' /><meta property='article:tag' content='æ•°æ®åº“' /><meta property='article:published_time' content='2022-08-12T14:46:53&#43;00:00'/><meta property='article:modified_time' content='2022-08-12T14:46:53&#43;00:00'/>
<meta name="twitter:title" content="JDBC">
<meta name="twitter:description" content="JDBC ç®€ä»‹ JDBC (Java DataBase Connectivity, Java æ•°æ®åº“è¿æ¥) æ˜¯ä½¿ç”¨Javaè¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥— API. JDBCå…¶å®æ˜¯SUNå…¬å¸åˆ¶è®¢çš„ä¸€å¥—æ“ä½œæ•°æ®åº“çš„æ ‡å‡†æ¥å£. JDBCä¸­å®šä¹‰">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

<style>
    .article-content {
        position: relative;
    }
    .article-content table, 
    .article-content tbody {
        white-space: normal;
        word-break: keep-all;
    }
    .article-content u {
        text-decoration-line: none;
        border-bottom: 1.5px solid;
        padding-bottom: 1.5px;
    }
    .article-content li {
        margin-bottom: 1.6em;
    }
    .article-content ul:last-child, 
    .article-content ol:last-child {
        margin-bottom: 0;
    }
    .article-content td * {
        margin-top: 0;
        padding-top: 0;
    }
    .article-content td ol, 
    .article-content td ul {
        padding-left: 1.2em;
    }
    .article-content td {
        padding-top: 1em;
    }
    .article-content td li {
        margin-bottom: 0.8em;
    }
</style>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu0c2331fe09320137a3bd1d4b5cc68791_142496_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Linner&#39;s Blog</a></h1>
            <h2 class="site-description">éšä¾¿çœ‹çœ‹å°±è¡Œï¼Œå‰¯æ ‡é¢˜æš‚æ—¶è¿˜æ²¡æƒ³å¥½</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/Linna-cy'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives" id="toc-list">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents"></nav>
            
        </div>
    </section>


            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/javaweb/" >
                JavaWeb
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/jdbc/">JDBC</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 12, 2022</time>
                |
            </div>
        

        

        <div class="article-time--reading">å…±4208å­—</div>
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="jdbc-ç®€ä»‹">JDBC ç®€ä»‹</h1>
<p>JDBC (Java DataBase Connectivity, Java æ•°æ®åº“è¿æ¥) æ˜¯ä½¿ç”¨Javaè¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥— API.</p>
<p>JDBCå…¶å®æ˜¯SUNå…¬å¸åˆ¶è®¢çš„ä¸€å¥—æ“ä½œæ•°æ®åº“çš„æ ‡å‡†æ¥å£. JDBCä¸­å®šä¹‰äº†æ‰€æœ‰æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™. ç”±å„è‡ªçš„æ•°æ®åº“å‚å•†ç»™å‡ºå®ç°ç±» (é©±åŠ¨jaråŒ…).</p>
<p>Java, JDBCå’Œå„ç§æ•°æ®åº“çš„å…³ç³»å¦‚ä¸‹å›¾:</p>
<p><img src="/p/jdbc/1662106467207.png"
	width="756"
	height="421"
	srcset="/p/jdbc/1662106467207_hube4a86de29a56017127210466ce8a313_43094_480x0_resize_box_3.png 480w, /p/jdbc/1662106467207_hube4a86de29a56017127210466ce8a313_43094_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<p>ä½¿ç”¨JDBCçš„å¥½å¤„:</p>
<ul>
<li>ä¸éœ€è¦é’ˆå¯¹ä¸åŒæ•°æ®åº“åˆ†åˆ«å¼€å‘.</li>
<li>å¯éšæ—¶æ›¿æ¢åº•å±‚æ•°æ®åº“, è®¿é—®æ•°æ®åº“çš„Javaä»£ç åŸºæœ¬ä¸å˜.</li>
</ul>
<hr>
<h1 id="jdbc-ä½¿ç”¨çš„åŸºæœ¬æ­¥éª¤">JDBC ä½¿ç”¨çš„åŸºæœ¬æ­¥éª¤</h1>
<ol>
<li>
<p>å¯¼å…¥JDBCé©±åŠ¨jaråŒ…:</p>
<ul>
<li>
<p>ä¸‹è½½MySQL jaré©±åŠ¨åŒ…, <a class="link" href="https://www.runoob.com/java/java-mysql-connect.html#:~:text=Java%20%E8%BF%9E%E6%8E%A5%20MySQL%20%E9%9C%80%E8%A6%81%E9%A9%B1%E5%8A%A8%E5%8C%85%EF%BC%8C%E6%9C%80%E6%96%B0%E7%89%88%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%E4%B8%BA%EF%BC%9A%20http%3A%2F%2Fdev.mysql.com%2Fdownloads%2Fconnector%2Fj%2F%20%EF%BC%8C%E8%A7%A3%E5%8E%8B%E5%90%8E%E5%BE%97%E5%88%B0%20jar%20%E5%BA%93%E6%96%87%E4%BB%B6%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%E5%AF%B9%E5%BA%94%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%AF%BC%E5%85%A5%E8%AF%A5%E5%BA%93%E6%96%87%E4%BB%B6%E3%80%82,%E4%BD%A0%E5%8F%AF%E4%BB%A5%E4%B8%8B%E8%BD%BD%E6%9C%AC%E7%AB%99%E6%8F%90%E4%BE%9B%E7%9A%84%20jar%20%E5%8C%85%EF%BC%9A%20mysql-connector-java-5.1.39-bin.jar%20%E6%9C%AC%E5%AE%9E%E4%BE%8B%E4%BD%BF%E7%94%A8%E7%9A%84%E6%98%AF%20Eclipse%EF%BC%8C%E5%AF%BC%E5%85%A5%20jar%20%E5%8C%85%EF%BC%9A"  target="_blank" rel="noopener"
    >èœé¸Ÿæ•™ç¨‹ Java MySQL è¿æ¥</a>ã€‚</p>
</li>
<li>
<p>åœ¨é¡¹ç›®ä¸­, å°†ä¸‹è½½å¥½çš„jaråŒ…æ”¾å…¥é¡¹ç›®çš„ <code>lib</code>ç›®å½•ä¸­.</p>
</li>
<li>
<p>ç„¶åç‚¹å‡»é¼ æ ‡å³é”®&ndash;&gt;Add as Library (æ·»åŠ ä¸ºåº“).</p>
</li>
<li>
<p>åœ¨æ·»åŠ ä¸ºåº“æ–‡ä»¶çš„æ—¶å€™ï¼Œæœ‰å¦‚ä¸‹ä¸‰ä¸ªé€‰é¡¹:</p>
<ul>
<li>
<p>Global Library: å…¨å±€æœ‰æ•ˆ</p>
</li>
<li>
<p>Project Library: é¡¹ç›®æœ‰æ•ˆ</p>
</li>
<li>
<p>Module Library: æ¨¡å—æœ‰æ•ˆ</p>
<p>é€‰æ‹©Global Library.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æ³¨å†Œé©±åŠ¨:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Class<span style="color:#f92672">.</span><span style="color:#a6e22e">forName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#f92672">);</span>
</code></pre></div><blockquote>
<p>MySQLæä¾›çš„ <code>Driver</code>çš„é™æ€ä»£ç å—ä¼šè‡ªåŠ¨æ‰§è¡Œ <code>DriverManager.registerDriver()</code> æ–¹æ³•æ¥æ³¨å†Œé©±åŠ¨. æ‰€ä»¥æˆ‘ä»¬åªéœ€åŠ è½½ <code>Driver</code>å³å¯.
MySQL5ä¹‹åçš„é©±åŠ¨åŒ…, å¯ä»¥çœç•¥æ³¨å†Œé©±åŠ¨çš„æ­¥éª¤.</p>
</blockquote>
</li>
<li>
<p>è·å–æ•°æ®åº“è¿æ¥:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>url<span style="color:#f92672">,</span> username<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>
</code></pre></div><ul>
<li>
<p>å…¶ä¸­, <code>url</code>, <code>username</code>å’Œ <code>password</code>éƒ½æ˜¯ <code>String</code>ç±»å‹.</p>
</li>
<li>
<p><code>url</code>æ ¼å¼:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">jdbc:æ•°æ®åº“è½¯ä»¶åç§°://ipåœ°å€æˆ–åŸŸå:ç«¯å£/æ•°æ®åº“åç§°?å‚æ•°é”®å€¼å¯¹1&amp;å‚æ•°é”®å€¼å¯¹2...
</code></pre></div><p>ä¾‹å¦‚, è¿æ¥æœ¬åœ°mysqlä¸­åä¸ºtestçš„æ•°æ®åº“:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">jdbc:mysql://127.0.0.1:3306/test
</code></pre></div><p>æœ¬åœ°mysql, ä¸”ç«¯å£ä¸º3306, urlå¯ç®€å†™ä¸º:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">jdbc:mysql:///æ•°æ®åº“åç§°?å‚æ•°é”®å€¼å¯¹
</code></pre></div><p>å¸¸ç”¨çš„å‚æ•°é”®å€¼å¯¹æœ‰:</p>
<pre tabindex="0"><code>useSSL=false            // ç¦ç”¨å®‰å…¨è¿æ¥æ–¹å¼, è§£å†³è­¦å‘Šæç¤º
useServerPrepStmts=true // å¼€å¯é¢„ç¼–è¯‘(é»˜è®¤ä¸ºfalse)
serverTimezone=GMT%2B8  // è®¾ç½®æ—¶åŒº, ä¸œå…«åŒº(å³GMT+8)
serverTimezone=Asia/Shanghai    // è®¾ç½®æ—¶åŒºä¸œå…«åŒº
useUnicode=true&amp;characterEncoding=UTF-8 // è®¾ç½®å­—ç¬¦é›†ä¸ºUTF-8
</code></pre></li>
</ul>
</li>
<li>
<p>è·å–æ‰§è¡ŒSQLå¯¹è±¡:</p>
<p>æ‰§è¡ŒSQLè¯­å¥éœ€è¦SQLæ‰§è¡Œå¯¹è±¡ (<code>Statement</code>å¯¹è±¡):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Statement stmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">createStatement</span><span style="color:#f92672">();</span>
</code></pre></div><p><code>Statement</code>å¯¹è±¡å­˜åœ¨å®‰å…¨é—®é¢˜ (SQLæ³¨å…¥ç­‰é—®é¢˜), è€Œä½¿ç”¨ <code>PreparedStatement</code>ä¸ä»…å¯ä»¥æå‡æŸ¥è¯¢é€Ÿåº¦, è€Œä¸”è¿˜èƒ½é˜²æ­¢SQLæ³¨å…¥é—®é¢˜.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;...SQLè¯­å¥...&#34;</span><span style="color:#f92672">;</span>
PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
</code></pre></div></li>
<li>
<p>æ‰§è¡ŒSQLè¯­å¥:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeUpdate</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
</code></pre></div><p>ç”¨äºæ‰§è¡ŒDML, DDLè¯­å¥.</p>
<p>æˆ–è€…:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">ResultSet rs <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
</code></pre></div><p>ç”¨äºæ‰§è¡ŒDQLè¯­å¥.</p>
</li>
<li>
<p>å¤„ç†è¿”å›ç»“æœ</p>
</li>
<li>
<p>é‡Šæ”¾èµ„æº:</p>
<p><code>ResultSet</code>ã€<code>Statement</code>å’Œ <code>Connection</code>å¯¹è±¡éƒ½è¦ <code>&lt;i&gt;</code>æŒ‰ç…§é¡ºåº <code>&lt;/i&gt;</code>é‡Šæ”¾èµ„æº.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">rs<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
stmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</code></pre></div></li>
</ol>
<p>å¤§è‡´ä»£ç å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> java.sql.*<span style="color:#f92672">;</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JDBCDemo</span> <span style="color:#f92672">{</span>
  
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>

        <span style="color:#75715e">// - æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç 
</span><span style="color:#75715e"></span>        String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;...&#34;</span><span style="color:#f92672">;</span>
        String pwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;...&#34;</span><span style="color:#f92672">;</span>
    
        <span style="color:#75715e">// 1. æ³¨å†Œé©±åŠ¨ï¼ˆè£…è½½ç±»ï¼Œå¹¶å®ä¾‹åŒ–ï¼‰
</span><span style="color:#75715e"></span>        Class<span style="color:#f92672">.</span><span style="color:#a6e22e">forName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#f92672">);</span>
    
        <span style="color:#75715e">// 2. è·å–è¿æ¥
</span><span style="color:#75715e"></span>        String url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jdbc:mysql://127.0.0.1:3306/test&#34;</span> <span style="color:#f92672">+</span> 
                <span style="color:#e6db74">&#34;?useServerPrepStmts=true&#34;</span><span style="color:#f92672">;</span>
        String username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">;</span>
        String password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">;</span>
        Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>url<span style="color:#f92672">,</span> username<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>
    
        <span style="color:#75715e">// 3. å®šä¹‰SQLè¯­å¥ (ç”¨?ä½œå ä½ç¬¦)
</span><span style="color:#75715e"></span>        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id,username,password&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; FROM tb_user&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; WHERE username = ?&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; AND password = ?&#34;</span><span style="color:#f92672">;</span>
    
        <span style="color:#75715e">// 4. è·å–æ‰§è¡ŒSQLçš„PreparedStatementå¯¹è±¡
</span><span style="color:#75715e"></span>        PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
        <span style="color:#75715e">// è®¾ç½®å‚æ•°ï¼ˆ?ï¼‰çš„å€¼ pstmt.setXxx(index, value)
</span><span style="color:#75715e"></span>        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> name<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>2<span style="color:#f92672">,</span> pwd<span style="color:#f92672">);</span>
    
        <span style="color:#75715e">// 5. æ‰§è¡ŒSQL
</span><span style="color:#75715e"></span>        ResultSet rs <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">();</span>
    
        <span style="color:#75715e">// 6. å¤„ç†ç»“æœ
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">/*
</span><span style="color:#75715e">                ...
</span><span style="color:#75715e">            */</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// 7. é‡Šæ”¾èµ„æº
</span><span style="color:#75715e"></span>        rs<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><hr>
<h1 id="preparedstatement-å¯¹è±¡">PreparedStatement å¯¹è±¡</h1>
<p>PreparedStatement å¯¹è±¡å¯ä»¥:</p>
<ul>
<li>é¢„ç¼–è¯‘SQLè¯­å¥å¹¶æ‰§è¡Œ</li>
<li>é¢„é˜²SQLæ³¨å…¥é—®é¢˜</li>
</ul>
<p>è·å– <code>PreparedStatement</code>éœ€è¦å…ˆä¼ å…¥SQLè¯­å¥:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// SQLè¯­å¥ä¸­çš„å‚æ•°å€¼,ä½¿ç”¨ ? å ä½ç¬¦æ›¿ä»£
</span><span style="color:#75715e"></span>String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id,username,password&#34;</span> <span style="color:#f92672">+</span>
        <span style="color:#e6db74">&#34; FROM tb_user&#34;</span> <span style="color:#f92672">+</span>
        <span style="color:#e6db74">&#34; WHERE username = ?&#34;</span> <span style="color:#f92672">+</span>
        <span style="color:#e6db74">&#34; AND password = ?&#34;</span><span style="color:#f92672">;</span>

<span style="color:#75715e">// é€šè¿‡Connectionå¯¹è±¡è·å–PreparedStatement, å¹¶ä¼ å…¥å¯¹åº”çš„SQLè¯­å¥
</span><span style="color:#75715e"></span>PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
</code></pre></div><p>æ¥ç€æˆ‘ä»¬éœ€è¦è®¾ç½®SQLå¯¹è±¡ä¸­çš„å‚æ•°å€¼:</p>
<p>ä½¿ç”¨ <code>pstmt.setXxx(index, value)</code>, ç»™ <code>?</code> èµ‹å€¼. å…¶ä¸­, <code>index</code>çš„å€¼ä» <code>1</code>å¼€å§‹, <code>value</code>çš„ç±»å‹ä¸º <code>Xxx</code>æˆ– <code>xxx</code>.</p>
<p>ä¾‹å¦‚, ç»™ <code>int</code>ç±»å‹çš„ <code>value</code>èµ‹å€¼ä½¿ç”¨ <code>setInt()</code>, <code>String</code>ç±»å‹ä½¿ç”¨ <code>setString()</code>. é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ <code>setFloat()</code>, <code>setDouble()</code>, <code>setArray()</code>, <code>setByte()</code>ç­‰.</p>
<p>å¦‚æœ <code>prepareStatement()</code>æ–¹æ³•ä¼ å…¥çš„æ˜¯DML, DDLè¯­å¥, åˆ™ä½¿ç”¨ <code>executeUpdate()</code> æ–¹æ³•:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">executeUpdate</span><span style="color:#f92672">()</span> 
            <span style="color:#66d9ef">throws</span> SQLException
</code></pre></div><p>å¦‚æœè¯¥æ–¹æ³•æ‰§è¡Œçš„æ˜¯DMLè¯­å¥ (<code>INSERT</code>, <code>UPDATE</code>å’Œ <code>DELETE</code>), åˆ™è¿”å›DMLè¯­å¥æ“ä½œçš„è¡Œæ•°; å¦‚æœæ˜¯DDLè¯­å¥åˆ™è¿”å› 0.</p>
<blockquote>
<p>éœ€è¦æ³¨æ„, åœ¨å¼€å‘ä¸­å¾ˆå°‘ä½¿ç”¨javaä»£ç æ“ä½œDDLè¯­å¥.</p>
</blockquote>
<p>å¦‚æœ <code>prepareStatement()</code>æ–¹æ³•ä¼ å…¥çš„æ˜¯DQLè¯­å¥ (<code>SELECT</code>), ä½¿ç”¨çš„æ˜¯ <code>executeQuery()</code> æ–¹æ³•:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">ResultSet <span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">()</span>
                <span style="color:#66d9ef">throws</span> SQLException
</code></pre></div><p>è¯¥æ–¹æ³•è¿”å›çš„æ˜¯DQLè¯­å¥æŸ¥è¯¢åçš„ç»“æœé›†.</p>
<p>åœ¨ä½¿ç”¨ <code>PreparedStatement</code>å¯¹è±¡å, éœ€è¦ä½¿ç”¨ <code>close()</code>æ–¹æ³•é‡Šæ”¾èµ„æº.</p>
<h2 id="statement-å’Œ-preparedstatement">Statement å’Œ PreparedStatement</h2>
<p><code>Statement</code> å¯¹è±¡çš„ä¸€èˆ¬ç”¨æ³•å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;UPDATE tb_user SET password = \&#34;abc\&#34; WHERE id = 1&#34;</span><span style="color:#f92672">;</span>
Statement stmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">createStatement</span><span style="color:#f92672">();</span>
<span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> stmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeUpdate</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
</code></pre></div><p><code>Statement</code>çš„SQLè¯­å¥æ˜¯ä½œä¸º <code>executeUpdate()</code>å’Œ <code>executeQuery()</code>çš„å‚æ•°ä¼ å…¥, è€Œ <code>PreparedStatement</code>åˆ™æ˜¯åœ¨åˆ›å»ºå¯¹è±¡å°±å·²ç»ä½œä¸º <code>prepareStatement()</code>æ–¹æ³•çš„å‚æ•°ä¼ å…¥.</p>
<p>è¿™æ˜¯å› ä¸º <code>PreparedStatement</code>éœ€è¦é¢„å…ˆä¼ å…¥SQLè¯­å¥, æ¥èµ·åˆ°é¢„ç¼–è¯‘SQLè¯­å¥å’Œé¢„é˜²SQLæ³¨å…¥é—®é¢˜.</p>
<h2 id="é¢„ç¼–è¯‘">é¢„ç¼–è¯‘</h2>
<p>ä¸€èˆ¬æƒ…å†µä¸‹, javaæ‰§è¡ŒSQLè¯­å¥çš„è¿‡ç¨‹å¦‚ä¸‹:</p>
<p>javaç¨‹åºè¯·æ±‚æ•°æ®åº“æ‰§è¡ŒSQLè¯­å¥å:</p>
<ul>
<li>æ£€æŸ¥: æ•°æ®åº“æ¥æ”¶æŒ‡ä»¤, æ£€æŸ¥SQLè¯­æ³•</li>
<li>ç¼–è¯‘: å¦‚æœSQLè¯­å¥æ— è¯­æ³•é”™è¯¯, åˆ™å°†è¯¥è¯­å¥ç¼–è¯‘æˆå¯æ‰§è¡Œçš„å‡½æ•°</li>
<li>æ‰§è¡Œ: ç¼–è¯‘å®Œæˆåæ‰§è¡ŒSQLè¯­å¥</li>
</ul>
<p>è€Œæ£€æŸ¥SQLå’Œç¼–è¯‘SQLèŠ±è´¹çš„æ—¶é—´æ¯”æ‰§è¡ŒSQLçš„æ—¶é—´è¿˜è¦é•¿, å¦‚æœéœ€è¦ä¸€æ¬¡æ€§æ‰§è¡Œå¤šæ¡SQLè¯­å¥, é‚£ä¼šæµªè´¹å¤§é‡æ—¶é—´å’Œèµ„æº. æ‰€ä»¥, <code>PreparedStatement</code>çš„å‡ºç°è§£å†³äº†è¿™ä¸ªé—®é¢˜.</p>
<p>é€šè¿‡ä½¿ç”¨ <code>PreparedStatement</code>å¯¹è±¡, å¹¶ä¸”åœ¨è¿æ¥æ•°æ®åº“çš„ <code>url</code>ä¸­æ·»åŠ  <code>useServerPrepStmts=true</code>å‚æ•°æ¥å¼€å¯SQLè¯­å¥é¢„ç¼–è¯‘åŠŸèƒ½. é¢„ç¼–è¯‘åŠŸèƒ½ä¼šå°†æˆ‘ä»¬è®¾ç½®çš„SQLè¯­å¥ (å¦‚ <code>&quot;SELECT id,username,password FROM tb_user WHERE username = ? AND password = ?&quot;</code>) é¢„å…ˆä¼ ç»™æ•°æ®åº“, è®©å…¶å…ˆå®Œæˆæ£€æŸ¥å’Œç¼–è¯‘çš„å·¥ä½œ (å…ˆå®Œæˆè€—æ—¶çš„å·¥ä½œ), ç„¶åå†ä¸€æ¬¡æ€§æ‰§è¡Œæ‰€æœ‰SQLè¯­å¥ (è¿™äº›SQLè¯­å¥éƒ½æ˜¯ç›¸åŒçš„, åªæ˜¯å ä½ç¬¦å¤„è®¾ç½®çš„å€¼ä¸åŒ).</p>
<h2 id="sqlæ³¨å…¥">SQLæ³¨å…¥</h2>
<p>SQLæ³¨å…¥æ˜¯æŒ‡é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•æäº¤, æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸², æœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤.</p>
<p>è€Œ <code>PreparedStatement</code>é€šè¿‡åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨ <code>?</code>å ä½ç¬¦, å¹¶ä¸”ä½¿ç”¨ç›¸åº”çš„ <code>setXxx()</code>æ–¹æ³•æ¥è®¾ç½®å€¼ (è®¾ç½®çš„å€¼å¦‚æœå«æœ‰ç‰¹æ®Šå­—ç¬¦, å¦‚ <code>&quot;</code> å’Œ <code>'</code> ç­‰, åˆ™ä¼šè¿›è¡Œè½¬ä¹‰), é˜²æ­¢äº†SQLæ³¨å…¥çš„å‘ç”Ÿ.</p>
<p>ä¸‹é¢ä»£ç è¯´æ˜äº† <code>PreparedStatement</code>å¦‚ä½•é˜²æ­¢SQLæ³¨å…¥:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Demo</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// useServerPrepStmts=trueå¼€å¯é¢„ç¼–è¯‘
</span><span style="color:#75715e"></span>        String url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jdbc:mysql:///test?useSSL=false&amp;useServerPrepStmts=true&#34;</span><span style="color:#f92672">;</span>
        String username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">;</span>
        String password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n546,Lin0&#34;</span><span style="color:#f92672">;</span>
        Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>url<span style="color:#f92672">,</span> username<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>

        <span style="color:#75715e">// - æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç 
</span><span style="color:#75715e"></span>        String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;zhangsan&#34;</span><span style="color:#f92672">;</span>
        String pwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; OR &#39;1&#39; = &#39;1&#34;</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// - å®šä¹‰SQLï¼ˆç”¨?ä½œå ä½ç¬¦ï¼‰
</span><span style="color:#75715e"></span>        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id,username,password&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; FROM tb_user&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; WHERE username = ?&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; AND password = ?&#34;</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// - è·å–PreparedStatementå¯¹è±¡
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//   - é¢„ç¼–è¯‘SQLï¼Œæ€§èƒ½æ›´é«˜
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//     é»˜è®¤å…³é—­ï¼Œåœ¨urlåŠ ä¸Šå‚æ•°useServerPrepStmts=trueå¼€å¯
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//   - é˜²æ­¢SQLæ³¨å…¥
</span><span style="color:#75715e"></span>        PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>

        <span style="color:#75715e">// - è®¾ç½®å‚æ•°ï¼ˆ?ï¼‰çš„å€¼
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//   - é˜²æ³¨å…¥åŸç†ï¼š
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//     å­—ç¬¦ä¸²å‚æ•°åœ¨setStringä¸­ä¼šè¢«è½¬ä¹‰ï¼Œ
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//     å³æ•´ä¸ªå‚æ•°è¢«å½“æˆsqlé‡Œé¢çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯javaçš„å­—ç¬¦ä¸²
</span><span style="color:#75715e"></span>        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> name<span style="color:#f92672">);</span>
        <span style="color:#75715e">// ä»mysqlæ—¥å¿—æ–‡ä»¶å¯ä»¥å‘ç°ï¼š
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// &#39; OR &#39;1&#39; = &#39;1 è½¬ä¹‰æˆäº† \&#39; OR \&#39;1\&#39; = \&#39;1
</span><span style="color:#75715e"></span>        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>2<span style="color:#f92672">,</span> pwd<span style="color:#f92672">);</span>

        <span style="color:#75715e">// - æ‰§è¡ŒSQL
</span><span style="color:#75715e"></span>        ResultSet rs <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">();</span>

        <span style="color:#75715e">// - åˆ¤è¯»ç™»å½•æ˜¯å¦æˆåŠŸ
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç™»å½•æˆåŠŸï¼&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç™»é™†å¤±è´¥ï¼&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>

        rs<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>ä¸‹é¢ä»£ç æ¼”ç¤ºäº†æŠŠSQLä»£ç ç‰‡æ®µæ’å…¥åˆ°SQLå‘½ä»¤, æ¥è¿›è¡Œå…å¯†ç™»å½•:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LoginInject</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
        String url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jdbc:mysql:///test&#34;</span><span style="color:#f92672">;</span>
        String username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">;</span>
        String password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">;</span>
        Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>url<span style="color:#f92672">,</span> username<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>

        <span style="color:#75715e">// æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç 
</span><span style="color:#75715e"></span>        String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefg&#34;</span><span style="color:#f92672">;</span> <span style="color:#75715e">// ç”¨æˆ·åéšæ„
</span><span style="color:#75715e"></span>        String pwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39; OR &#39;1&#39; = &#39;1&#34;</span><span style="color:#f92672">;</span> <span style="color:#75715e">// å¯†ç ä¼ å…¥SQLä»£ç ç‰‡æ®µ
</span><span style="color:#75715e"></span>
        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id,username,password&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; FROM tb_user&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; WHERE username = &#39;&#34;</span> <span style="color:#f92672">+</span> name <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34;&#39; AND password = &#39;&#34;</span><span style="color:#f92672">+</span> pwd <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;&#34;</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">// å°†sqlè¯­å¥whereéƒ¨åˆ†å±•å¼€ï¼š
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// WHERE username = &#39;abcdefg&#39; AND password = &#39;&#39; OR &#39;1&#39; = &#39;1&#39;
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// å‘ç°whereè¯­å¥æ¡ä»¶å§‹ç»ˆä¸ºçœŸ
</span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>

        Statement stmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">createStatement</span><span style="color:#f92672">();</span>
        ResultSet rs <span style="color:#f92672">=</span> stmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>

        <span style="color:#75715e">// åˆ¤è¯»ç™»å½•æ˜¯å¦æˆåŠŸ
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç™»å½•æˆåŠŸï¼&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç™»é™†å¤±è´¥ï¼&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// è¿”å›çš„æ˜¯ç™»å½•æˆåŠŸ
</span><span style="color:#75715e"></span>
        rs<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        stmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><hr>
<h1 id="resultset-å¯¹è±¡">ResultSet å¯¹è±¡</h1>
<p><code>ResultSet</code> (ç»“æœé›†å¯¹è±¡) ä½œç”¨: å°è£…äº†SQLæŸ¥è¯¢è¯­å¥çš„ç»“æœ, æ˜¯ <code>executeQuery()</code>æ–¹æ³•çš„è¿”å›å€¼ç±»å‹.</p>
<p><code>ResultSet</code>å¯¹è±¡æœ‰ä¸‰ä¸ªæ–¹æ³•:</p>
<ul>
<li>
<p><code>next()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">next</span><span style="color:#f92672">()</span>
        <span style="color:#66d9ef">throws</span> SQLException
</code></pre></div><p>æ¯æ¬¡æ‰§è¡Œæ—¶, å°†å…‰æ ‡ä»å½“å‰ä½ç½®å‘å‰ç§»åŠ¨ä¸€è¡Œ (å…‰æ ‡ä»ç¬¬0è¡Œå¼€å§‹), å¹¶ä¸”åˆ¤æ–­å½“å‰è¡Œæ˜¯å¦ä¸ºæœ‰æ•ˆè¡Œ (è¿”å› <code>true</code>åˆ™ä»£è¡¨ä¸ºæœ‰æ•ˆè¡Œ)ã€‚</p>
</li>
<li>
<p><code>getXxx()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">xxx <span style="color:#a6e22e">getXxx</span><span style="color:#f92672">(</span>arg<span style="color:#f92672">)</span>
        <span style="color:#66d9ef">throws</span> SQLException
</code></pre></div><p>argç±»å‹:</p>
<ul>
<li><code>int</code>: ä»£è¡¨åˆ—çš„ç¼–å· (æŒ‰ç…§ <code>SELECT</code>è¯­å¥ä¸­çš„æŸ¥è¯¢é¡ºåº), ä»1å¼€å§‹</li>
<li><code>String</code>: åˆ—çš„åç§°</li>
</ul>
</li>
<li>
<p><code>close()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">close</span><span style="color:#f92672">()</span>
        <span style="color:#66d9ef">throws</span> SQLException
</code></pre></div><p>é‡Šæ”¾ <code>ResultSet</code>å¯¹è±¡.</p>
</li>
</ul>
<p>ä¸‹é¢æ¼”ç¤ºäº† <code>ResultSet</code>çš„ä½¿ç”¨:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Demo</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>
        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id,username,password FROM tb_user&#34;</span><span style="color:#f92672">;</span>
        Statement stmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">createStatement</span><span style="color:#f92672">();</span>
        PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
        <span style="color:#75715e">// - å¤„ç†ç»“æœï¼Œéå†rsä¸­çš„æ‰€æœ‰æ•°æ®
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//   - rs.next()ï¼šå…‰æ ‡å‘ä¸‹ç§»åŠ¨ä¸€è¡Œï¼Œå¹¶åˆ¤æ–­å½“å‰è¡Œæ˜¯å¦æœ‰æ•ˆ
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">// - è·å–æ•°æ® getXxx()
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">int</span> id <span style="color:#f92672">=</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getInt</span><span style="color:#f92672">(</span>1<span style="color:#f92672">);</span>
            <span style="color:#75715e">// getXxx()æ–¹æ³•å¯ä»¥ä½¿ç”¨åˆ—ç´¢å¼•ï¼ˆä»1å¼€å§‹ï¼‰ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ—å
</span><span style="color:#75715e"></span>            String usrname <span style="color:#f92672">=</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">);</span>
            String passwd <span style="color:#f92672">=</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span>3<span style="color:#f92672">);</span>

            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id: &#34;</span> <span style="color:#f92672">+</span> id<span style="color:#f92672">);</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username: &#34;</span> <span style="color:#f92672">+</span> usrname<span style="color:#f92672">);</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;passwd: &#34;</span> <span style="color:#f92672">+</span> passwd<span style="color:#f92672">);</span>
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;-----------------------&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// - é‡Šæ”¾èµ„æº
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// ResultSetã€Statementå’ŒConnectionéƒ½è¦æŒ‰ç…§é¡ºåºé‡Šæ”¾èµ„æº
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// å…ˆé‡Šæ”¾ResultSet, å†é‡Šæ”¾Statement, æœ€åæ˜¯Connection
</span><span style="color:#75715e"></span>        rs<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        stmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><hr>
<h1 id="æ“ä½œå®ä¾‹">æ“ä½œå®ä¾‹</h1>
<p>ç”¨æˆ·è´¦å·å¯†ç å¢åˆ æ”¹æ“ä½œ.</p>
<p>åœ¨ç¼–å†™JDBCä»£ç ä¹‹å‰éœ€è¦å…ˆå®Œæˆåˆ›å»ºæ•°æ®åº“, åˆ›å»º <code>pojo</code>åŒ…å¹¶ç¼–å†™ <code>User</code>å®ä½“ç±»çš„å·¥ä½œ:</p>
<ol>
<li>
<p>åˆ›å»ºæ•°æ®åº“å¹¶è¿è¡Œä¸‹æ–¹SQLä»£ç :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#75715e">-- åˆ é™¤tb_userè¡¨
</span><span style="color:#75715e"></span><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">EXISTS</span> tb_user;
<span style="color:#75715e">-- åˆ›å»ºtb_userè¡¨
</span><span style="color:#75715e"></span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#a6e22e">tb_user</span>(
    id <span style="color:#66d9ef">INT</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> <span style="color:#66d9ef">AUTO_INCREMENT</span>,
    username <span style="color:#66d9ef">VARCHAR</span>(<span style="color:#ae81ff">20</span>),
    password <span style="color:#66d9ef">VARCHAR</span>(<span style="color:#ae81ff">32</span>)
);

<span style="color:#75715e">-- æ·»åŠ æ•°æ®
</span><span style="color:#75715e"></span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> tb_user <span style="color:#66d9ef">VALUES</span>(<span style="color:#66d9ef">NULL</span>, <span style="color:#e6db74">&#39;zhangsan&#39;</span>, <span style="color:#e6db74">&#39;123&#39;</span>), (<span style="color:#66d9ef">NULL</span>, <span style="color:#e6db74">&#39;lisi&#39;</span>, <span style="color:#e6db74">&#39;234&#39;</span>);
</code></pre></div></li>
<li>
<p>åˆ›å»º <code>pojo</code>åŒ…, å¹¶åœ¨åŒ…ä¸­æ·»åŠ  <code>User</code>å®ä½“ç±»:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">package</span> pojo<span style="color:#f92672">;</span> <span style="color:#75715e">// pojoåŒ…å­˜æ”¾å®ä½“ç±»
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> Integer id<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String username<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String password<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">public</span> Integer <span style="color:#a6e22e">getId</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> id<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setId</span><span style="color:#f92672">(</span>Integer id<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> id<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getUsername</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> username<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUsername</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">username</span> <span style="color:#f92672">=</span> username<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getPassword</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> password<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setPassword</span><span style="color:#f92672">(</span>String password<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">password</span> <span style="color:#f92672">=</span> password<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toString</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Account{&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34;id=&#34;</span> <span style="color:#f92672">+</span> id <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34;, username=&#39;&#34;</span> <span style="color:#f92672">+</span> username <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;\&#39;&#39;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34;, password=&#39;&#34;</span> <span style="color:#f92672">+</span> password <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;\&#39;&#39;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#39;}&#39;</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div></li>
</ol>
<h2 id="å¢åˆ æ”¹æ“ä½œ">å¢åˆ æ”¹æ“ä½œ</h2>
<p>JDBCæ•°æ®è®¿é—®å±‚çš„ä»£ç æ”¾åœ¨ <code>DAO</code>åŒ…ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">package</span> dao<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> pojo.User<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> java.sql.*<span style="color:#f92672">;</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserDAO</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> String URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jdbc:mysql:///test&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34;?useSSL=false&amp;useServerPrepStmts=true&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> String USERNAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> String PASSWORD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">;</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * æ ¹æ®ç”¨æˆ·åå’Œå¯†ç æŸ¥è¯¢
</span><span style="color:#75715e">     * @param username
</span><span style="color:#75715e">     * @param password
</span><span style="color:#75715e">     * @return User
</span><span style="color:#75715e">     * @throws SQLException
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> User <span style="color:#a6e22e">select</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">,</span> String password<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> SQLException <span style="color:#f92672">{</span>

        <span style="color:#75715e">// å‚æ•°æœ‰nullå€¼æ—¶
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>username <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> password <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// è¿æ¥æ•°æ®åº“
</span><span style="color:#75715e"></span>        Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>URL<span style="color:#f92672">,</span> USERNAME<span style="color:#f92672">,</span> PASSWORD<span style="color:#f92672">);</span>

        <span style="color:#75715e">// è·å–PreparedStatementå¯¹è±¡, å¹¶è®¾ç½®SQLè¯­å¥
</span><span style="color:#75715e"></span>        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id, username, password&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; FROM tb_user&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; WHERE username = ?&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; AND password = ?&#34;</span><span style="color:#f92672">;</span>
        PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> username<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>2<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>

        <span style="color:#75715e">// è·å–ResultSet
</span><span style="color:#75715e"></span>        ResultSet rs <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">();</span>

        User user <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
            user <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> User<span style="color:#f92672">();</span>

            Integer id <span style="color:#f92672">=</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getInt</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">);</span>
            String name <span style="color:#f92672">=</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">);</span>
            String pw <span style="color:#f92672">=</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span><span style="color:#f92672">);</span>

            user<span style="color:#f92672">.</span><span style="color:#a6e22e">setId</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
            user<span style="color:#f92672">.</span><span style="color:#a6e22e">setUsername</span><span style="color:#f92672">(</span>name<span style="color:#f92672">);</span>
            user<span style="color:#f92672">.</span><span style="color:#a6e22e">setPassword</span><span style="color:#f92672">(</span>pw<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>

        rs<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>

        <span style="color:#66d9ef">return</span> user<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * æ ¹æ®ç”¨æˆ·åå’Œå¯†ç æ·»åŠ æ•°æ®
</span><span style="color:#75715e">     * @param username
</span><span style="color:#75715e">     * @param password
</span><span style="color:#75715e">     * @return boolean
</span><span style="color:#75715e">     * @throws SQLException
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">,</span> String password<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> SQLException <span style="color:#f92672">{</span>

        Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>URL<span style="color:#f92672">,</span> USERNAME<span style="color:#f92672">,</span> PASSWORD<span style="color:#f92672">);</span>

        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;INSERT INTO tb_user&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; VALUE(null, ?, ?)&#34;</span><span style="color:#f92672">;</span>
        PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> username<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>2<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>

        <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeUpdate</span><span style="color:#f92672">();</span>

        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>

        <span style="color:#66d9ef">return</span> count <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * æ ¹æ®ç”¨æˆ·åå’Œå¯†ç åˆ é™¤æ•°æ®
</span><span style="color:#75715e">     * @param username
</span><span style="color:#75715e">     * @param password
</span><span style="color:#75715e">     * @return boolean
</span><span style="color:#75715e">     * @throws SQLException
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">,</span> String password<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> SQLException <span style="color:#f92672">{</span>

        Connection conn <span style="color:#f92672">=</span> DriverManager<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">(</span>URL<span style="color:#f92672">,</span> USERNAME<span style="color:#f92672">,</span> PASSWORD<span style="color:#f92672">);</span>

        String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;DELETE FROM tb_user&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; WHERE username = ?&#34;</span> <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; AND password = ?&#34;</span><span style="color:#f92672">;</span>
        PreparedStatement pstmt <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> username<span style="color:#f92672">);</span>
        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span>2<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>

        <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">executeUpdate</span><span style="color:#f92672">();</span>

        pstmt<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        conn<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>

        <span style="color:#66d9ef">return</span> count <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

</code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/javaweb/">JavaWeb</a>
        
            <a href="/tags/java/">Java</a>
        
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
       
</article>


    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                

<section class="tagCloud" style="margin-right: 10px;">
<div class="tagCloud-tags">
    <a href="/p/mybatis/">
        
        

        MyBatis</a>
</div>
</section>

            
                

<section class="tagCloud" style="margin-right: 10px;">
<div class="tagCloud-tags">
    <a href="/p/druid-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/">
        
        

        Druid æ•°æ®åº“è¿æ¥æ± </a>
</div>
</section>

            
                

<section class="tagCloud" style="margin-right: 10px;">
<div class="tagCloud-tags">
    <a href="/p/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/">
        
        

        ç‘å‰å¤–å–é¡¹ç›®å®æˆ˜</a>
</div>
</section>

            
                

<section class="tagCloud" style="margin-right: 10px;">
<div class="tagCloud-tags">
    <a href="/p/mybatisplus/">
        
        

        MyBatisPlus</a>
</div>
</section>

            
                

<section class="tagCloud" style="margin-right: 10px;">
<div class="tagCloud-tags">
    <a href="/p/springmvc-%E5%9F%BA%E7%A1%80/">
        
        

        SpringMVC åŸºç¡€</a>
</div>
</section>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2023 Linner&#39;s Blog

        <span style="padding-left: 5px;padding-right: 5px;">|</span>

        <a href="https://beian.miit.gov.cn/" target="_blank" >ç²¤ICPå¤‡2022125602å·-1</a>
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
